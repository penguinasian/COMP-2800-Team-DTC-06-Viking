<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!--Favicon links-->
    <link rel="apple-touch-icon" sizes="180x180" href="../favicon/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="../favicon/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="../favicon/favicon-16x16.png">
    <link rel="manifest" href="../favicon/site.webmanifest">
    <link rel="mask-icon" href="../favicon/safari-pinned-tab.svg" color="#4c744c">
    <link rel="shortcut icon" href="../favicon/favicon.ico">
    <meta name="msapplication-TileColor" content="#4c744c">
    <meta name="msapplication-config" content="../favicon/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <!--End Favicon links-->

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-BmbxuPwQa2lc/FVzBcNJ7UAyJxM6wuqIj61tLrc4wSX0szH/Ev+nYRRuWlolflfl" crossorigin="anonymous">
    <link type="text/css" rel="stylesheet" href="https://www.gstatic.com/firebasejs/ui/4.6.1/firebase-ui-auth.css" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.4.0/font/bootstrap-icons.css">
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Sofia">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="./css/routes_detail_page.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <script src="https://kit.fontawesome.com/9d9ca769a8.js" crossorigin="anonymous"></script>

    <title>Parking_main</title>
</head>

<body>
    <header>
        <div class="appname d-flex flex-row justify-content-center align-items-center sticky-top" style="height:10vh">
            <div class="logoName">
                <img src="./images/logo_final.png">
            </div>
        </div>
    </header>

    <!-- All elements go into main-->
    <main>
        <div class="detailsPage">

        </div>
    </main>


    <!-- Bottom: parking, services, routes, info and profile icons -->
    <nav class="navbar navbar-expand fixed-bottom d-flex align-items-center">
        <div class="container-fluid">
            <div class="bottomIcon parking">
                <button class="btn iconButton parking" onclick="document.location='./parking_main.html'"><i class="fas fa-biking parking"></i></button>
                <p class="footer">Parking</p>
            </div>

            <div class="bottomIcon services">
                <button class="btn iconButton" onclick="document.location='./services.html'"><i class="fas fa-map-marked services"></i></button>
                <p class="footer">Services</p>
            </div>
            <div class="bottomIcon routes">
                <button class="btn iconButton" onclick="document.location='./popular_routes.html'"><i class="far fa-compass routes"></i></i></button>
                <p class="footer">Routes</p>
            </div>
            <div class="bottomIcon info">
                <button class="btn iconButton" href="#"><i class="fas fa-info-circle info"></i></i></button>
                <p class="footer">Info</p>
            </div>
            <div class="bottomIcon profile">
                <button class="btn iconButton" href="#"><i class="fas fa-user-circle profile"></i></button>
                <p class="footer">Profile</p>
            </div>
            </div>
        </div>
    </nav>


    <!----------------------------------------------->
    <!-- JS: Boostrap, Firebase, API related    -->
    <!----------------------------------------------->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta2/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-b5kHyXgcpbZJO/tY9Ul7kGkf1S0CWuKcCD38l8YkeH8z8QjE0GmW1gYU5S9FOnJ0" crossorigin="anonymous">
        </script>
    <script src="https://www.gstatic.com/firebasejs/8.2.9/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.2.9/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.2.9/firebase-firestore.js"></script>
    <script src="https://www.gstatic.com/firebasejs/ui/4.6.1/firebase-ui-auth.js"></script>
    <script src="./javascripts/firebase_api.js"></script>
    <!--------------------------------------------------------------------->
    <!-- JS files: Your own JavaScript functions included here    -->
    <!--------------------------------------------------------------------->

    <script>
        function add_RoutesDetail(id, pic, Length, level, description, name) {

            //create a div for bike route title on the top
            let route_title_div = document.createElement("div")
            route_title_div.className = "route_title"
            let route_title = document.createElement("h1")
            route_title.innerText = name
            route_title_div.appendChild(route_title)

            //create an image tag
            let image = document.createElement("iframe")
            image.setAttribute("src", pic)

            //create a div for routes details under the map image
            let routes_detail = document.createElement("div")
            routes_detail.className = "routesDetail"

            //create a div to contain all the texts
            let details_text = document.createElement("div")
            details_text.className = "detailsText"

            let level_text = document.createElement("p")
            level_text.innerHTML = level
            details_text.appendChild(level_text)

            let length_text = document.createElement("p")
            length_text.innerHTML = "Length:"
            length_text.className = "text"
            details_text.appendChild(length_text)
        
            let length_value = document.createElement("p")
            length_value.innerHTML = Length
            details_text.appendChild(length_value)

            let length_unit = document.createElement("p")
            length_unit.className = "unit"
            length_unit.innerHTML = "km"
            details_text.appendChild(length_unit)

            routes_detail.appendChild(image)
            routes_detail.appendChild(details_text)
            
            //create a paragraph to describe the route
            let route_para = document.createElement("p")
            route_para.className = "routePara"
            route_para.innerText = description

            //append child divs to parent div
            document.getElementsByClassName("detailsPage")[0].appendChild(route_title_div)
            document.getElementsByClassName("detailsPage")[0].appendChild(routes_detail)
            document.getElementsByClassName("detailsPage")[0].appendChild(route_para)
            
        }


        function readPopularRoutesName(id) {
          

                db.collection("popular_routes").where("name", "==", value)
                    .get().then(function (result) {
                           let doc = result.docs[0]
                            add_RoutesDetail(doc.id, doc.data().pic, doc.data().Length
                                , doc.data().level, doc.data().description, doc.data().name)
                        
                    })     

        }


        const params = new URLSearchParams(window.location.search)
        const value = params.get('name')

        readPopularRoutesName(value)
    </script>
            
    </body>

</html>